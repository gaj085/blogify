<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('./partials/head') %>
    <title>Blog</title>
</head>

<body>
  <%- include('./partials/nav') %>
  <%- include('./partials/scripts') %>

  <div class="container mt-4">
    <div class="text-center">
      <h1> <%= blog.title %> </h1>
      <img src="<%= blog.coverImageURL %>" width="600px"> 
    </div>

    <pre class="mt-3" style="white-space: pre-wrap;"> <%= blog.body %> </pre>
  </div>

  <div class="container mt-4">
    <img src="<%= blog.createdBy.profileImageURL %>" width="50px"> <%= blog.createdBy.fullName %>
  </div>

  <div class="container mt-4">
    <h1> Comments(<%= comments.length %>) </h1>

    <% if (locals.user) { %>
      <img src="<%= user.profileImageURL %>" width="50px">
      <%= user.fullName %>

      <form action="/blog/comment/<%= blog._id %>" method="post">
        <div class="mb-3">
          <input type="text" class="content" id="content" name="content" placeholder="Enter your comment">
          <button class="btn btn-sn btn-primary" type="submit">Add</button>
        </div>
      </form>
    <% } %>
  </div>

  <div class="container mt-4">
    <% comments.forEach(comment => { %>
      <div class="container mt-3">
        <img src="<%= comment.createdBy.profileImageURL %>" width="50px">
        <%= comment.createdBy.fullName %>

        <% if (comment.createdBy._id.toString() === blog.createdBy._id.toString()) { %>
          <p style="display: inline; font-weight: bold; font-size: 15px;"> (Author)</p>
        <% } %>

        <pre><%= comment.content %></pre>
      </div>
    <% }) %>
  </div>
</body>
</html>